# 🚀 RAC Folder Search - 自动化发布指南

## 📋 发布方式总览

我已经为你配置了 **3 种发布方式**，从简单到完全自动化：

### 1. 🚀 **全自动发布**（推荐）
```bash
./自动发布.sh
```
- ✅ 自动编译、测试、打包
- ✅ 自动提交代码到 GitHub
- ✅ 自动创建 Git Tag
- ✅ 自动创建 GitHub Release（需要 GitHub CLI）

### 2. ⚡ **快速发布**
```bash
./快速发布.sh
```
- ✅ 快速编译和打包
- ✅ 提交代码和创建 Tag
- ⚠️ 需要手动创建 GitHub Release

### 3. 🤖 **GitHub Actions 自动化**
- ✅ 推送 Tag 时自动触发
- ✅ 自动构建和发布
- ✅ 支持多平台测试

---

## 🎯 立即发布（推荐流程）

### 方法 A：使用全自动脚本

```bash
# 1. 运行全自动发布脚本
./自动发布.sh

# 就这么简单！脚本会自动完成所有步骤
```

### 方法 B：使用 GitHub Actions

```bash
# 1. 推送代码
git add .
git commit -m "Release v1.0.2"
git push origin main

# 2. 创建并推送 Tag
git tag -a "v1.0.2" -m "Release v1.0.2"
git push origin "v1.0.2"

# 3. GitHub Actions 会自动创建 Release
```

---

## 📝 发布前准备

### 1. 安装可选依赖（提升体验）

```bash
# 安装 GitHub CLI（用于自动创建 Release）
brew install gh  # macOS
# 或
curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null
sudo apt update && sudo apt install gh  # Ubuntu/Debian

# 登录 GitHub CLI
gh auth login
```

### 2. 配置 Git 用户信息（如果未配置）

```bash
git config --global user.name "你的名字"
git config --global user.email "你的邮箱"
```

---

## 🔧 配置文件说明

### 已创建的文件

| 文件 | 用途 |
|------|------|
| `自动发布.sh` | 全自动发布脚本 |
| `快速发布.sh` | 快速发布脚本 |
| `.github/workflows/release.yml` | GitHub Actions 发布工作流 |
| `.github/workflows/ci.yml` | 持续集成工作流 |
| `发布配置.json` | 发布配置信息 |
| `自动化发布指南.md` | 本文件 |

### package.json 更新

已更新仓库地址为：`https://github.com/iczrac/rac-folder-search`

---

## 🎯 发布步骤详解

### 全自动发布脚本做了什么？

1. **检查依赖**：Git, Node.js, npm
2. **编译项目**：`npm run compile`
3. **运行测试**：`npm test`（如果失败会继续）
4. **打包扩展**：生成 `.vsix` 文件
5. **配置 Git**：初始化仓库和远程地址
6. **提交代码**：添加、提交、推送到 GitHub
7. **创建 Tag**：创建版本标签
8. **创建 Release**：使用 GitHub CLI 自动创建（如果可用）

### GitHub Actions 工作流

#### CI 工作流（`.github/workflows/ci.yml`）
- **触发条件**：推送到 main/develop 分支，或创建 PR
- **测试矩阵**：Ubuntu/Windows/macOS × Node.js 16/18/20
- **执行步骤**：ESLint → 编译 → 测试 → 打包

#### Release 工作流（`.github/workflows/release.yml`）
- **触发条件**：推送 Tag（`v*`）或手动触发
- **执行步骤**：编译 → 测试 → 打包 → 创建 Release

---

## 🚀 立即开始发布

### 选择你的发布方式：

#### 🎯 **方式 1：一键全自动**（最简单）

```bash
./自动发布.sh
```

#### ⚡ **方式 2：快速发布**（需要手动创建 Release）

```bash
./快速发布.sh
```

然后访问：https://github.com/iczrac/rac-folder-search/releases/new

#### 🤖 **方式 3：GitHub Actions**（最专业）

```bash
git tag -a "v1.0.2" -m "Release v1.0.2"
git push origin "v1.0.2"
```

---

## ✅ 发布后验证

发布完成后，检查以下内容：

1. **GitHub 仓库**：https://github.com/iczrac/rac-folder-search
   - ✅ 代码已推送
   - ✅ README 显示正常

2. **GitHub Releases**：https://github.com/iczrac/rac-folder-search/releases
   - ✅ Release v1.0.2 已创建
   - ✅ .vsix 文件可下载

3. **本地文件**：
   - ✅ `rac-folder-search-1.0.2.vsix` 已生成

---

## 🔄 后续版本发布

当你需要发布新版本时：

1. **更新版本号**：修改 `package.json` 中的 `version`
2. **更新脚本**：修改脚本中的版本号
3. **运行发布**：选择上述任一发布方式

---

## 🆘 故障排除

### 问题：推送失败（认证错误）

**解决方案**：
```bash
# 使用 Personal Access Token
# 1. 访问：https://github.com/settings/tokens
# 2. 创建 token（勾选 repo 权限）
# 3. 推送时使用 token 作为密码
```

### 问题：GitHub CLI 未安装

**解决方案**：
```bash
# macOS
brew install gh

# Ubuntu/Debian
curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null
sudo apt update && sudo apt install gh

# 登录
gh auth login
```

### 问题：vsce 未安装

**解决方案**：
```bash
npm install -g @vscode/vsce
```

---

## 🎉 总结

你现在有了完整的自动化发布流程：

- ✅ **3 种发布方式**：全自动、快速、GitHub Actions
- ✅ **完整的 CI/CD**：自动测试、构建、发布
- ✅ **故障排除指南**：解决常见问题
- ✅ **版本管理**：自动化版本标签和 Release

**推荐使用全自动发布脚本**：`./自动发布.sh`

---

**立即开始发布你的 RAC Folder Search 扩展！** 🚀